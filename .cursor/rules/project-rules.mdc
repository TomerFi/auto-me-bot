# Auto-Me-Bot Project Rules

## Project Overview
This is a Probot GitHub App that automates repository management through configurable handlers.

## Architecture
- **Config Types**: Event types (currently only 'pr')
- **Handlers**: Operations for config types (located in src/handlers/)
- **Handler Contract**: Each handler exports match() and run() functions

## Handler Development Rules

### Handler Structure
Every handler in src/handlers/ MUST export:
1. `match(context)` - Returns boolean, determines if handler should run
2. `run(context, config, startedAt)` - Async function that executes handler logic

### Handler Lifecycle (PR handlers)
1. Create check-run with status 'in_progress'
2. Perform handler operations
3. Update check-run with status 'completed' and appropriate conclusion

### Testing Requirements
- Test match() and run() separately
- Mock all GitHub API calls (context.octokit)
- Achieve full coverage for handler logic
- Use descriptive test names

## Tech Stack
- Runtime: Node.js 22+
- Framework: Probot 14+
- Testing: Mocha + Chai + Sinon
- Coverage: c8
- Linting: ESLint 9+
- Docs: MkDocs (Python)

## Coding Standards
- Indentation: 4 spaces for JS
- Line length: 100 chars (JS), 120 chars (Markdown)
- Async patterns: async/await (no raw Promises)
- Error handling: Always catch and report API errors

## Configuration
- User config: .github/auto-me-bot.yml
- Handler registration: src/auto-me-bot.js CONFIG_SPEC
- Event registration: src/auto-me-bot.js ON_EVENTS

## Dependencies
- Use npm ci for CI/CD
- Keep Probot and commitlint updated
- Pin action versions in workflows
